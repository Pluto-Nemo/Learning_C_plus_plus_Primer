# 2.2 变量

**变量**提供一个具名的、可供程序操作的存储空间。

在C++中，变量（variable）和对象（object）一般可以互换使用。



### 2.2.1 变量定义

变量定义的基本形式：

首先是**类型说明符** （type specifier），随后紧跟由一个或多个变量名组成的列表，其中变量名以**逗号**分隔，最后以分号结束。定义时可以为一个或多个变量赋初值。

```cpp
//例：
int sum = 0, value, units_sold = 0;
```



#### 初始值

当对象在创建时获得了一个特定的值，这个对象被**初始化**（initialized）了。

- 用于初始化变量的值可以是任意复杂的表达式。
- 可以用先定义的变量值去初始化后定义的其他变量。



**列表初始化**（list initialization）：

一种使用**花括号**来初始化变量的形式。

特别地，如果我们使用列表初始化且初始值存在丢失信息的风险，则编译器将报错。

```cpp
//例：
int unit1 = {0};
int unit2{0};
```



**默认初始化**（default initialized）：

如果定义变量时**没有指定初始值**，则变量被默认初始化，被赋予了“默认值”。默认值具体由**变量类型**和**定义变量的位置**共同决定。

几种默认初始化情况：

- 如果内置类型的变量未被显式初始化，它的值由定义的位置决定。
- 定义于任何函数体之外的变量，被初始化为0。
- 定义在函数体内部的内置类型变量将**不被初始化**（uninitialized），其值是未定义的，如果试图拷贝或以其他形式访问将引发错误。
- 每个类各自决定其初始化对象的方式。



#### 区分：初始化和赋值

初始化：在创建变量时赋予一个初始值

赋值：把对象的当前值擦除，以一个新值替代





### 2.2.2 变量声明和定义的关系

为了允许把程序拆分成多个逻辑部分来编写，C++语言支持**分离式编译**（separate compilation）机制。该机制允许将程序分割为若干个文件，每个文件可被独立编译。

为支持分离式编译，C++将声明与定义区分开：

- **声明**（declaration）：使得名字为程序所知。一个文件如果想使用别处定义的名字则必须包含对那个名字的声明。
  - 声明方法：在变量名前添加关键字extern，且不要显式初始化变量。
- **定义**（definition）：负责创建与名字关联的实体

二者都规定了变量的类型和名字，但除此之外，定义还申请存储空间，也可能会为变量赋初始值。

变量能且只能被定义一次，但是可以被多次声明。

#### 静态类型

C++是一种静态类型（statically typed）语言，其含义是：在**编译**阶段检查类型。





### 2.2.3 标识符

标识符（identifier）由**字母**、**数字**和**下划线**组成，其中**必须以字母或下划线开头**，且是大小写敏感的。不能连续出现两个下划线，也不能以下划线紧连大写字母开头。

定义标识符时应遵循一定的变量命名规范，以提高程序的可读性。

另外，C++保留了一些名字供语言本身使用，这些名字不能用作标识符。（具体可查阅表2.3和2.4）



### 2.2.4 名字的作用域

**作用域**（scope）是程序的一部分，在其中名字有特定的含义，大多数作用域都以花括号分隔。

名字的有效区域始于名字的声明语句，终于声明语句所在的作用域末端。同一名字在不同的作用域中可能指向不同的实体。

**全局作用域**（global scope）：定义在函数体之外的名字拥有全局作用域。一旦声明之后，全局作用域内的名字在整个程序的范围内都可使用。

**块作用域**（block scope）：任何一对花括号中的语句集都属于一个块，在这之中定义的所有变量在代码块外都是不可见的，我们称之为块级作用域。



#### 嵌套的作用域

作用域可以彼此包含。

**内层作用域**（inner scope）：被包含（嵌套）的作用域称为内层作用域。

**外层作用域**（outer scope）：包含着别的作用域的作用域称为外层作用域。

作用域中一旦声明了某个名字，它的所有内层作用域都能访问该名字。

允许在内层作用域中重新定义外层作用域已有的名字。（但不建议）