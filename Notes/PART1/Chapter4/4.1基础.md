# 4.1 基础

表达式由一个或多个**运算对象**（operand）组成，对表达式求值将得到一个**结果**（result）。

把一个**运算符**（operator）和一个或多个运算对象组合起来可以生成较复杂的表达式。



### 4.1.1 基本概念

#### 根据运算对象的数量

一元运算符（unary operator）：作用于一个运算对象的运算符

二元运算符（binary operator）：作用于两个运算对象的运算符

三元运算符以此类推

函数调用也是一种特殊的运算符，对运算对象的数量没有限制。



#### 重载运算符

当运算符作用于**类**类型的运算对象时，用户可以自行定义其含义，因为这种自定义的过程事实上是为已存在的运算符赋予了另外一层含义，所以称之为**重载运算符**（overloaded operator）

注意：运算对象的个数，运算符的优先级和结合律是无法改变的。



#### 左值和右值

**左值**（lvalue） ：能取到地址的表达式

**右值**（rvalue）：取不到地址的表达式

当一个对象被用作**右值**时，用的是对象的**值（内容）**；当对象被用作**左值**的时候，用的是对象的**身份（在内存中的位置）**。

在需要右值的地方可以用左值代替，但不能把右值当成左值使用。当一个左值被当成右值使用时，实际使用的是他的值（内容）。

**目前已知的几种要用到左值的运算符：**

- 赋值运算符
- 取地址符
- 内置解引用运算符、下标运算符、迭代器解引用运算符、string和vector的下标运算符
- 



### 4.1.2 优先级与结合律

**复合表达式**（compound expression）是指含有两个或多个运算符的表达式。要理解它的含义首先要理解运算符的**优先级**（precedence）、**结合律**（associativity）以及运算对象的**求值顺序**（order of evaluation）。

**几个重要的规则：**

- 表达式最终的值依赖于其子表达式的组合方式
- 高优先级运算符的运算对象要比低优先级运算符的运算对象更为紧密地组合在一起
- 如何优先级相同，则其组合规则由结合律规定
- 括号无视优先级与结合律

p147列出了运算符优先级表



### 4.1.3 求值顺序

对于那些没有指定执行顺序的运算符来说，如果表达式指向并修改了同一个对象， 将会引发错误并产生未定义的行为。

**有4种运算符明确规定了运算对象的求值顺序**：

- 逻辑与运算符 `&&` ：先求左侧运算对象的值，只有该值为真时才继续求右侧运算对象的值
- 逻辑或运算符 `||`：见4.3节 
- 条件运算符 `?:` ：见4.7节
- 逗号运算符`,`：见4.10节

**两个处理符合表达式的建议**：

- 拿不准时最好用括号来强制让表达式的组合关系符合程序逻辑的要求

- 如果改变了某个运算对象的值，在表达式的其他地方不要再使用这个运算对象

  除非改变运算对象的字表达式本身就是另外一个子表达式的运算对象时，该规则无效