# 3.2 标准库类型string

标准库类型**string**定义在命名空间std中，表示可变长的字符序列，使用string类型必须首先包含string头文件。



### 3.2.1 定义和初始化string对象

初始化string对象的方式：

```cpp
//默认初始化，s1为空串
string s1;			  //1
//s2是s1的副本
string s2(s1);		  //2
string s2 = s1;		  //3
//s3是字面值"value"的副本，字面值最后的空字符除外
string s3("value");	  //4
string s3 = "value";  //5
//s4初始化为由连续n个字符c组成的串
string s4(n,'c');	  //6
```

#### 直接初始化和拷贝初始化

**拷贝初始化**（copy initialization）：使用等号初始化一个变量。（上面的3、5）

**直接初始化**（direct initialization）：不使用等号进行初始化。（上面的1、2、4）





### 3.2.2 string对象上的操作

#### 读写操作

可以使用IO操作符读写string对象。

执行读取操作时，string对象会自动**忽略开头的空白**（即空格符、换行符、制表符等），并从第一个真正的字符开始读起，直到遇见下一处空白为止。

##### 使用getline读取一整行：

当我们想在最终得到的字符串中**保留输入时的空白符**时，使用**getline**函数代替原来的>>运算符。

```cpp
getline(istream& is, string& str);//&暂时不用管，是后面函数参数传递要学的内容
```

**参数：**它有两个参数，一个输入流（如cin）和一个string对象，getline只要一遇到**换行符**就结束读取操作并返回结果，读取时换行符会被读入，但存入string对象时换行符不会被存入。

**返回值：**getline和输入运算符一样，也会**返回它的流参数**，因此也可以作为判断的条件，如：

```cpp
while(getline(cin,line))
```



#### empty和size操作

**empty**函数根据string对象是否为空返回一个对应的布尔值，常与**逻辑非运算符（!）**配合使用。

**size**函数返回string对象的长度（即string对象中字符的个数），可以与比较运算符配合使用以进行限制字符长度的操作。



#### string::size_type类型

size函数返回的是一个**string::size_type类型**的值。它是一个无符号类型的值，并且能足够存放下任何string对象的大小。

因为它是一个unsigned，所以需要注意不要和signed类型混用。

#### 

#### 比较操作

string类中定义了几类比较运算符。运算过程中，比较运算符会**逐一**比较string对象中的字符，并且**对大小写敏感**。

注意：

- string对象相等意味着它们的长度和包含的字符都相同。
- 相等性运算符和关系运算符都依照（大小写敏感的）字典顺序对string对象进行比较。

​			

#### 赋值操作

一般来说，在设计标准库类型时都力求在易用性上向内置类型看齐，因此大多数库类型都支持赋值操作，string对象也不例外，此处不再赘述。



#### 加操作

- **两个string对象相加**，其内容是把左侧的运算对象与右侧的运算对象串接而成。

- **字面值和string对象相加**，标准库会将字符字面值和字符串字面值转换成string对象后相加。

  注意不能把字面值直接相加，当把string对象和字符字面值及字符串字面值混在一条语句中使用时，必须确保每个加法运算符两侧的对象至少有一个是string。



更多操作查表3.2





### 3.2.3 处理string对象中的字符

在**cctype**头文件中定义了一组标准库函数，用于处理string对象中的字符。见表3.



#### 处理每个字符：使用基于范围的for语句

**范围for**（range  for）语句遍历给定序列中的每个元素并对序列中的每个值执行某种操作。其语法形式是：

```cpp
for (declaration:expression)
    statement
//每次迭代，declaration部分的变量会被初始化为expression部分的下一个元素值
```

一个string对象表示一个字符的序列，因此string对象可以作为范围for语句中的expression部分。

```cpp
//例：使用for语句和ispunct函数来统计string对象中标点符号的个数
for (auto c : s)	  //对于s中的每个字符
    if (ispunct(c))	  //如果该字符是标点符号
        ++punct_cnt;  //将标点符号的计数值加1
```

如果要改变string对象中字符的值，必须把循环变量定义成**引用类型**。

```cpp
//例：将字符串s中的每个字符转换成大写形式
for (auto &c : s)
    c = toupper(c);	  //c是一个引用，因此赋值语句将改变s中字符的值
```



#### 处理部分字符：使用下标运算符

**下标运算符**（[]）接收的输入参数是**string::size_type**类型的值，这个参数表示要访问的字符的位置；返回值是该位置上字符的引用。可以联系第二章的知识使用decltype（s.size())来定义表示下标的变量。

下标的值成为“下标”或“**索引**”，任何表达式只要它的值是一个整型就能作为索引。

可以使用下标进行迭代、随机访问等等。

使用时需注意：**检查下标的合法性**

- string对象的下标从0计起，string对象的下标必须大于等于0而小于s.size()

- 在访问指定字符前，要先检查那个位置是否为空，可以使用s.empty()进行检查

  

ps：还有一种方法是使用迭代器，在3.4节和第九章中介绍





#### 其他

**逻辑与运算符&&**：如果参与运算的两个运算对象都为真，则逻辑与结果为真，否则结果为假。

重要的一点是，只有当左侧运算对象为真时才会检查右侧的运算对象。